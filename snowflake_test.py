from secret_client import SecretClient
from snowflake_bi_client import SnowflakeBIGetter
from pympler import asizeof
from time import perf_counter

MAX_QUERY = [
    "102878",
    "131592",
    "131618",
    "150050",
    "197631",
    "206920",
    "289335",
    "177819",
    "151160",
    "320545",
    "46835",
    "51502",
    "51505",
    "54277",
    "61978",
    "65518",
    "67535",
    "237945",
    "76138",
    "103416",
    "46806",
    "57618",
    "139700",
    "151476",
    "77106",
    "184947",
    "794758",
    "101942",
    "85699",
    "124885",
    "85742",
    "86218",
    "86899",
    "90246",
    "51246",
    "47982",
    "131319",
    "91473",
    "918638",
    "140149",
    "100004",
    "112005",
    "133404",
    "139400",
    "1000053947",
    "186743",
    "205280",
    "134746",
    "206108",
    "213575",
    "221372",
    "227756",
    "229101",
    "103465",
    "230649",
    "244865",
    "232464",
    "267721",
    "223752",
    "267800",
    "103519",
    "285480",
    "301274",
    "305823",
    "264135",
    "322028",
    "322817",
    "288953",
    "334617",
    "193160",
    "328115",
    "340068",
    "350489",
    "148798",
    "355925",
    "356311",
    "169582",
    "135172",
    "47963",
    "173981",
    "326998",
    "203723",
    "286485",
    "219571",
    "204052",
    "152126",
    "282023",
    "241486",
    "271474",
    "340523",
    "283574",
    "577558",
    "284142",
    "192292",
    "131220",
    "288012",
    "278723",
    "196993",
    "281679",
    "212790",
    "281639",
    "361641",
    "337930",
    "264359",
    "214257",
    "323768",
    "210011",
    "230561",
    "289411",
    "123146",
    "354571",
    "141816",
    "156436",
    "252080",
    "328305",
    "60012",
    "205455",
    "625174",
    "309526",
    "642494",
    "197952",
    "648694",
    "324040",
    "186181",
    "69301",
    "71084",
    "351902",
    "72349",
    "310535",
    "191918",
    "257304",
    "609086",
    "137963",
    "353172",
    "697038",
    "65899",
    "360921",
    "179521",
    "356717",
    "183229",
    "47053",
    "744630",
    "148326",
    "264440",
    "298320",
    "194688",
    "1000044316",
    "121710",
    "322320",
    "327915",
    "295210",
    "174582",
    "65939",
    "76803",
    "201820",
    "133094",
    "781326",
    "149252",
    "1000027342",
    "74592",
    "223556",
    "217278",
    "369256",
    "1000001582",
    "142680",
    "370674",
    "104424",
    "207297",
    "361315",
    "79148",
    "179237",
    "143980",
    "59159",
    "108017",
    "127452",
    "197822",
    "142581",
    "74576",
    "1000031494",
    "63664",
    "250747",
    "516190",
    "242490",
    "290473",
    "121756",
    "250717",
    "677046",
    "193646",
    "815102",
    "125728",
    "605918",
    "50808",
    "339833",
    "83015",
    "80504",
    "838878",
    "84557",
    "267949",
    "129180",
    "61222",
    "215432",
    "253362",
    "370223",
    "851926",
    "150045",
    "243312",
    "100774",
    "198045",
    "111475",
    "190450",
    "574142",
    "148684",
    "298178",
    "136379",
    "159275",
    "346116",
    "299449",
    "369241",
    "202043",
    "277517",
    "131482",
    "263585",
    "103652",
    "287163",
    "324105",
    "208564",
    "160598",
    "717990",
    "123995",
    "280188",
    "318825",
    "318018",
    "191194",
    "319701",
    "131721",
    "362714",
    "70594",
    "79904",
    "344679",
    "117112",
    "134632",
    "657854",
    "114010",
    "115178",
    "280412",
    "872934",
    "271937",
    "202085",
    "340945",
    "372850",
    "211391",
    "316133",
    "201198",
    "285989",
    "154397",
    "137756",
    "355026",
    "158160",
    "208191",
    "56217",
    "337547",
    "232239",
    "302912",
    "158779",
    "48629",
    "141371",
    "354359",
    "368372",
    "225413",
    "294123",
    "262061",
    "178346",
    "839454",
    "308198",
    "176155",
    "80139",
    "324602",
    "253658",
    "248551",
    "803918",
    "347892",
    "217999",
    "873502",
    "189843",
    "369218",
    "110645",
    "345777",
    "187580",
    "158551",
    "350728",
    "219302",
    "282247",
    "228508",
    "288313",
    "293294",
    "180314",
    "756542",
    "250278",
    "153130",
    "87580",
    "570022",
    "287880",
    "859510",
    "65481",
    "87996",
    "195484",
    "626702",
    "67051",
    "253760",
    "337198",
    "100163",
    "88399",
    "119154",
    "286117",
    "881390",
    "355758",
    "150599",
    "290082",
    "294898",
    "229533",
    "57786",
    "343586",
    "288236",
    "1000010534",
    "577334",
    "119378",
    "626182",
    "269013",
    "365951",
    "510334",
    "169692",
    "88611",
    "151917",
    "541998",
    "575878",
    "156004",
    "46846",
    "293384",
    "126448",
    "101627",
    "1000017078",
    "203875",
    "640982",
    "84255",
    "195971",
    "327737",
    "515918",
    "151334",
    "206453",
    "161315",
    "127847",
    "63120",
    "132119",
    "367702",
    "666334",
    "509950",
    "114707",
    "366895",
    "354062",
    "365496",
    "182526",
    "240403",
    "362433",
    "284254",
    "319659",
    "305219",
    "341318",
    "239419",
    "506526",
    "50704",
    "198613",
    "63124",
    "254593",
    "265025",
    "294368",
    "1000031478",
    "222747",
    "339296",
    "109788",
    "352266",
    "52566",
    "371846",
    "321824",
    "300067",
    "47782",
    "284419",
    "1000041396",
    "364366",
    "294988",
    "664790",
    "1000009638",
    "172433",
    "189095",
    "121122",
    "269883",
    "256781",
    "162713",
    "249090",
    "191810",
    "891110",
    "173720",
    "164414",
    "795126",
    "362193",
    "243056",
    "352868",
    "647430",
    "210854",
    "89250",
    "337555",
    "84952",
    "324056",
    "71961",
    "330297",
    "836310",
    "137382",
    "734910",
    "60473",
    "307604",
    "211673",
    "254644",
    "123392",
    "188521",
    "214333",
    "710166",
    "1000042652",
    "735118",
    "133190",
    "212483",
    "103934",
    "219212",
    "113483",
    "249032",
    "350562",
    "679942",
    "324112",
    "210464",
    "229776",
    "340579",
    "236643",
    "254204",
    "662294",
    "351080",
    "793558",
    "192323",
    "283515",
    "239142",
    "161997",
    "798686",
    "698302",
    "90487",
    "74104",
    "1000032478",
    "316806",
    "370886",
    "319254",
    "640998",
    "315128",
    "250196",
    "54111",
    "296443",
    "346110",
    "280162",
    "302632",
    "266365",
    "342783",
    "79623",
    "335277",
    "164093",
    "288531",
    "282233",
    "342753",
    "562262",
    "332129",
    "120543",
    "362651",
    "140042",
    "139195",
    "349775",
    "264529",
    "113868",
    "363393",
    "665774",
    "222451",
    "105563",
    "363403",
    "321715",
    "112021",
    "334597",
    "890774",
    "353710",
    "238095",
    "649206",
    "182611",
    "293900",
    "311532",
    "255012",
    "134834",
    "225554",
    "916390",
]

if __name__ == "__main__":
    params = {"num_months_offset": 6, "part_numbers": MAX_QUERY}
    secret_client = SecretClient()
    tic = perf_counter()
    with SnowflakeBIGetter(secret_client) as bi_getter:
        with open("queries/map_msrp_query.sql", "r") as f:
            map_query = f.read()
        res = bi_getter.execute_query(map_query, params, debug=True)
    toc = perf_counter()
    print("time taken (seconds):", toc - tic)
    print("sizeof map_query(MB):", asizeof.asizeof(res) / 2**20)
